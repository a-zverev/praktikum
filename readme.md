Работа с ампликонными библиотеками 16s rDNA на примере QIIME2.

## Основной пайплайн



Основной пайплайн состоит из схожего количества шагов:

* Проверка данных
* Фильтрация по качеству
* Объединение парных ридов
* Фильтрация химер
* ОТU- или ASV-пикинг
* Таксономическая аннотация
* Нормализация
* Экологические индексы


## Работа на удаленном сервере
Управление сервером по протоколу ssh. Мы можем получить доступ как к удаленному терминалу, так и к файловой системе удаленного сервера.
Для работы с удаленным сервером нужно знать несколько параметров:

* адрес сервера: 178.236.129.66
* порт для подключения: 9911
* логин и пароль: perstuds/\*\*\*\*

#### Linux

* Подключение к удаленному терминалу:

    `ssh perstuds@178.236.129.66 -p 9911`

После подключения имя пользователя и имя вашего локального компьютера, указанное у вас в терминале, изменится на имя аккаунта на сервере.

* Копирование директории с сервера на локальную машину: 

    `scp -P 9911 -r perstuds@178.236.129.66:/home/perstuds/your_name/taxa_summary ~`

Обратите внимание, что команды копирования и присоединения по SSH выполняются на локальной машине, не на сервере)


* Можно монтировать файловую систему сервера к своей системе (возможно, надо будет дополнительно установить `sshfs`):

    `sshfs alexey@178.236.129.66:/home/alexey /home/alister/ARRIAM/ -p 9911 -o nonempty`

#### Windows

Для удаленной работы нужно скачать и установить ssh-клиент. Например, Bitwise SSH Client - его можно скачать [здесь](https://www.bitvise.com/ssh-client-download). В соответствующих полях заполните адрес сервера, порт, имя пользователя и пароль. После подключения вам должен быть доступен и удаленный терминал и окно обмена файлами.

### Правила безопасности

Поскольку мы будем работать не одни, у нас единое рабочее пространство. Чтобы не мешать друг другу, несколько моментов:

* работать в своей папке

* работать через менеджер сессий

* сохранять результаты себе на машину.


Создаем папку и переходим в нее:

    mkdir your_name
    cd your_name

Ваша рабочая директория (вывод команды pwd) должна выглядеть примерно так `/home/perstuds/your_name/`

### Менеджер сессий tmux
Чтобы не потерять данные после закрытия терминала, создайте свою сессию в менеджере сессий. Задачи, запущенные в tmux, остаются активными после обрыва соединения.

* Создать именованную сессию: `tmux new -s your_name`
* Посмотреть список сессий: `tmux ls`
* Подключиться к текущей сессии `tmux att -t your_name`

Команды tmux также можно посмотреть тут: https://tmuxcheatsheet.com/


## Утилиты и исходные данные

Исходные данные, как они выглядят, мы можем посмотреть в `/home/perstuds/raw`. Они хранятся в сжатом виде, и, чаще всего, уже разобраны по библиотекам. Исходные данные могут быть разного качества, и прежде чем работать с ними, стоит проверить их. Самый частый вариант - fastQC:


## Проверка качества

На нашем сервере fastqc установлена в окружении с другими утилитами для анализа. Для этого сначала надо поменять окружение

    `conda activate bioinf`

И запускать анализ

    `fastqc filename_R1_L001.fastq.gz`

## Dada2 in QIIME2

Также сменить окружение 

https://docs.qiime2.org/2021.8/tutorials/moving-pictures/